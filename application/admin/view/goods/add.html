{include file="public/header" /}
<link type="text/css" rel="stylesheet" href="__UM__/themes/default/css/umeditor.css"/>
<div class="layui-card">
	<div class="layui-card-header">新增商品</div>
	<div class="layui-card-body" style="padding:20px 10px">
		<form class="layui-form" lay-filter="addForm" id="addForm">
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">商品编号：</label>
					<div class="layui-input-inline">
						<input type="text" name="title" value="{$goods.title|default=$sn}" lay-verify="required" placeholder="请输入商品名称，最多200个字符" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">单位：</label>
					<div class="layui-input-inline">
						<input type="text" name="title" value="{$goods.uinit|default=''}" lay-verify="required" placeholder="请输入商品单位，比方：件" autocomplete="off" class="layui-input">
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">商品名称：</label>
				<div class="layui-input-block">
					<input type="text" name="title" value="{$goods.title|default=''}" lay-verify="required" placeholder="请输入商品名称，最多200个字符" autocomplete="off" class="layui-input">
				</div>
			</div>

			<div class="hr-line-dashed"></div>
			<div class="layui-form-item">
				<label class="layui-form-label">分类：</label>
				<div class="layui-input-block">
					{volist name="cate" id="v"}
					<div class="layui-col-xs4">
						<input type="radio" name="sex" value="nan" title="{$v.name}" {in name="v.id" value="$goods.group|default=1" }checked{/in}>
					</div>
					{/volist}
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">商品规格：</label>
				<div class="layui-input-block">
					<a class="layui-btn" id="addSpec"><i class="fa fa-plus"></i> 增加规格</a>
				</div>
			</div>
			<div class="hr-line-dashed"></div>

			<div class="layui-form-item">
				<label class="layui-form-label">相册：</label>
				<div class="layui-input-block">
					<div class="layui-upload-drag" id="test10">
						<i class="layui-icon"></i>
						<p>点击上传，或将文件拖拽到此处</p>
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">详细介绍：</label>
				<div class="layui-input-block">
					<!-- 加载编辑器的容器 -->
					<script id="description" name="description" type="text/plain">

					</script>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">状态：</label>
				<div class="layui-input-inline">
					<input type="checkbox" name="status" value="1"
					       {eq name="user.status|default='1'" value="1" }checked{/eq}
					lay-skin="switch" lay-text="开启|禁用" >
				</div>
				<div class="layui-form-mid layui-word-aux">默认开启</div>
			</div>
			<div class="hr-line-dashed2"></div>
			<div class="layui-form-item">
				<div class="layui-input-block">
					<input type="hidden" name="id" value="{$user.id|default=''}"/>
					<button class="layui-btn" lay-submit lay-filter="addForm">立即提交</button>
					<button type="reset" class="layui-btn layui-btn-primary">重置</button>
				</div>
			</div>
		</form>
	</div>
</div>
<script type="text/javascript" src="__UM__/umeditor.config.js"></script>
<script type="text/javascript" src="__UM__/umeditor.min.js"></script>
<script type="text/javascript">
	// 实例化编辑器
	var ue = UM.getEditor('description', {
		initialFrameWidth: '98%', //初始化编辑器宽度
		initialFrameHeight: 300  //初始化编辑器高度
	});
	layui.use(['form', 'layer', 'jquery'], function () {
		var form = layui.form,
			layer = layui.layer, $ = layui.jquery;
		//监听新增角色提交
		form.on('submit(addForm)', function (data) {
			var url = "{:url('goods/add')}?t=", okMsg = '系统用户创建成功'; // 添加
			if (data.field.id) {
				// 修改
				url = "{:url('admin/edit')}?t=";
				okMsg = '系统用户修改成功';
			}
			$.post(url + new Date().getTime(), data.field, function (result) {
				if (result.code == 1) {
					window.parent.location.reload(); //刷新父页面
					parent.layer.msg(okMsg, {icon: 1, time: 2000});
				} else {
					layer.msg(result.msg, {icon: 2});
				}
			}, 'json');
			return false;
		});
		// 添加商品规格监听
		$('#addForm').on('click', '#addSpec', function () {
			layer.open({
				type: 2,
				skin: 'layui-layer-molv',
				area: ['730px', '480px'],
				shadeClose: true,
				title: '商品规格（点选当前商品所需要规格）',
				content: "{:url('goods/spec_select')}"
			});
		});
	});
</script>
{include file="public/footer" /}